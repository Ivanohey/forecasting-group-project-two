# Exploratory data analysis 

## Univariate analysis

In this first part of our EDA, we will explore each variable on its own, before looking at the relationship between different variables.

### Plots of each variable over time: 

```{r}
#Flights plot 
ts_data %>% autoplot(Flights) +
  labs(title = "Flights over time", x = "Date", y = "Number of Flights")

#Price plot
ts_data %>% autoplot(Price) +
  labs(title = "Brent Oil Prices 2019 onwards", x = "Date", y = "Price")

#temp plot
ts_data %>% autoplot(temp) +
  labs(title = "Temperature over time", x = "Date", y = "Temperature in Celsius")

#precip plot
ts_data %>% autoplot(precip) +
  labs(title = "Precipitation over time", x = "Date", y = "Precipitation")

#snow plot
ts_data %>% autoplot(snow) +
  labs(title = "Snow over time", x = "Date", y = "Snow")

#windspeed plot
ts_data %>% autoplot(windspeed) +
  labs(title = "Windspeed over time", x = "Date", y = "Windspeed")

#visibility plot
ts_data %>% autoplot(visibility) +
  labs(title = "Visibility over time", x = "Date", y = "Visibility")

#humidity plot
ts_data %>% autoplot(humidity) +
  labs(title = "Humidity over time", x = "Date", y = "Humidity")


```
Here are some observations based on the data-over-time graphs above: 

- Number of Flights: There is a clear trend, and some possible seasonality. Also, the covid flight-restriction drop is extremely clear. After that, the number of flights seems to be steadily increasing (with some cycles) towards to its pre-covid level. However, from this graph we can argue that there tend to be more flights in the summer compared to the winter. A big factor causing this is obviously school holidays in the summer.
- Brent oil price: There is a clear trend, but not an obvious seasonality in the data at first glance. Further analysis is needed to determine the specifics.
- Temperature: Extremely seasonal data, without a clear trend. Always peaking in the summer months for the highest temperatures and in the winter months for the lowest ones.
- Precipitation: Difficult to interpret at this point, but some seasonality can be seen, with less precipitation in the summer months, and more in the winter months.
- Snow: Very bizarre that there's no snow at all in 2020, and then a huge peak in 2021. I need to analyze in more depth to see what's going on, but since there are so many zeros for most of the year, I'm not sure if snow as a variable will help forecast anything. 
- Windspeed: Very clear seasonality, with perhaps a downward trend for 2022-2023. 
- Visibility: Clear seasonality with the best visibility in the summer and worst in the winter. Also, the data is looking weird after 2022...
- Humidity: Clear seasonality with more humidity in the winter compared to the summer months.

### Specific plots for interesting variables 

Exploring snow in 2021 - It looks completely unusable because there is too little data. 

```{r}
#selecting data from november 2019 until march 2022 
ts_data %>% 
  filter(Date >= as.Date("2021-11-01") & Date <= as.Date("2022-03-31")) %>% 
  autoplot(snow)
```

Now lets look at what's happening to visibility:

```{r}
#selecting data from november 2019 until march 2022 
ts_data %>% 
  filter(Date >= as.Date("2021-12-01") & Date <= as.Date("2022-10-31")) %>% 
  autoplot(visibility)
```

This makes absolutely no sense, why is visibility consistently at the same value for almost all of 2022? Did something change in the weather or is this just wrong data? Probably the data is just wrong... If we do decide to use visibility in order to forecast, we will have to stop using visibility before the point where it gets weird (January 2022)


## Bivariate analysis

In this section of our EDA, we will explore the relationships between our variables, which will help us decide which to keep for our final forecasting analysis. 

Here are the specific correlations between our variables:

```{r}
cor(ts_data[,2:9])
```

Here's a heatmap of the correlations to help visualize the relationships between the variables: 

```{r}
plot_correlation(ts_data)

corr_matrix <- cor(ts_data[,2:9])

corrplot(corr_matrix, type = "upper", order = "hclust", tl.col = "black")
```

